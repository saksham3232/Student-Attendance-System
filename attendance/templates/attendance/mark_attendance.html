{% extends 'attendance/base.html' %}

{% block title %}Mark Attendance - Attendance System{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="fas fa-user-check"></i> Mark Attendance â€” {{ current_date }}</h1>
</div>

<form method="post" action="{% url 'mark_attendance' %}">
    {% csrf_token %}
    <input type="hidden" name="date" value="{{ current_date|date:'Y-m-d' }}">

    <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Student ID</th>
                    <th scope="col">Name</th>
                    <th scope="col" class="text-center">Attendance</th>
                </tr>
            </thead>
            <tbody>
                {% for row in students %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ row.student.student_id }}</td>
                    <td>{{ row.student.name }}</td>
                    <td class="text-center">
                        <div class="d-flex justify-content-center gap-3">
                            <div class="form-check">
                                <input class="form-check-input" type="radio"
                                       name="attendance-{{ row.student.student_id }}"
                                       id="present-{{ row.student.student_id }}"
                                       value="present"
                                       {% if row.status == 'present' %}checked{% endif %}>
                                <label class="form-check-label" for="present-{{ row.student.student_id }}">
                                    Present
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio"
                                       name="attendance-{{ row.student.student_id }}"
                                       id="absent-{{ row.student.student_id }}"
                                       value="absent"
                                       {% if row.status == 'absent' %}checked{% endif %}>
                                <label class="form-check-label" for="absent-{{ row.student.student_id }}">
                                    Absent
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio"
                                       name="attendance-{{ row.student.student_id }}"
                                       id="late-{{ row.student.student_id }}"
                                       value="late"
                                       {% if row.status == 'late' %}checked{% endif %}>
                                <label class="form-check-label" for="late-{{ row.student.student_id }}">
                                    Late
                                </label>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="mt-3 text-end">
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-save"></i> Submit Attendance
        </button>
    </div>
</form>
{% endblock %}
